<!doctype html>
<html>
  <head>
    <style>
      #map {
        width: 800px;
        height: 800px;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
{% load staticfiles %}
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script src="{% static "gmaps.js" %}"></script>
    <script>
function getRandomColour(){
	var letters="0123456789ABCDEF";
	var colour="#";
	for(loop_var=0;loop_var<6;loop_var++)
	{
		colour+=letters[Math.floor(Math.random()*16)];
	}
	return colour;
}
data=JSON.parse('{{ data|safe}}');//[[48.8577262,2.2928475],[48.8576973,2.292387],[48.8575015,2.2912906]]
      var map = new GMaps({
        el: '#map',
        lat: data[0]["Houses"][0].point.coordinates[1],
        lng: data[0]["Houses"][0].point.coordinates[0]
      });
console.log(data[0]["Houses"][0].point.coordinates[1]);
console.log(Object.keys(data).length);
for(x=0;x<Object.keys(data).length;x++)
{
console.log(data[x]);
var contentInfo="Income: "+(data[x]["Houses"][0].income).toString()+"<br>";
for(j=0;j<data[x]["Members"].length;j++){
contentInfo+=data[x]["Members"][j].Name+", "+data[x]["Members"][j].Age+", "+data[x]["Members"][j].Gender+"<br>";
}
for(j=0;j<data[x]["Photos"].length;j++){
contentInfo+="<img src='http://10.0.3.23:8003"+data[x]["Photos"][j].file+"' height='200' width='200'>";
}
for (i = 0; i < data[x]["Houses"].length; i++) {
    map.addMarker({
  lat: data[x]["Houses"][i].point.coordinates[1],
  lng: data[x]["Houses"][i].point.coordinates[0],
infoWindow: {
    content: contentInfo,
maxwidth:100
  }
});}
//vaishnav,I'm going to kill you
for (i = 0; i < data[x]["Wells"].length; i++) {
var contentInfo='<b>Yield,Date</b><br>'
for(j=0;j<data[x]["Wells"][i].Yields.length;j++){
contentInfo+=data[x]["Wells"][i].Yields[j].Yield+", "+data[x]["Wells"][i].Yields[j].measured_date+"<br>";
}
    map.addMarker({
  lat: data[x]["Wells"][i].point.coordinates[1],
  lng: data[x]["Wells"][i].point.coordinates[0],

 icon:'http://maps.google.com/mapfiles/ms/micons/water.png',
infoWindow: {
    content: contentInfo,
    maxWidth: 100
  }
});}
//var paths=[[[48.8586341,2.2960675],[48.8586341,2.2960675],[48.8571539,2.2907279],[48.8568504,2.2909585]]]
for(i=0;i<data[x]["Farms"].length;i++){
var temp=[]  
  for(j=0;j<data[x]["Farms"][i].plot.coordinates[0].length;j++)
  {
	temp.push(data[x]["Farms"][i].plot.coordinates[0][j].reverse());
  }
  var contentInfo="<ul type='disc'><li>Area:"+(data[x]['Farms'][i].area).toString()+"</li><li>Crops:<ol type='I'>";
  for(j=0;j<data[x]['Farms'][i]['Crops'].length;j++)
  {
	contentInfo+="<li>Crop name:"+data[x]['Farms'][i]['Crops'][j].Name+"<br><ul type='circle'><li>Year:"+(data[x]['Farms'][i]['Crops'][j].Year).toString()+"</li><li>Season:"+data[x]['Farms'][i]['Crops'][j].Seasons+"</li></ul></li>";
  }

  contentInfo+="</ol></li></ul>";
var infoWindow = new google.maps.InfoWindow({
  content: contentInfo
});
  map.drawPolygon({
  paths: temp,
  strokeColor: '#000000',
  strokeOpacity: 0.3,
  strokeWeight: 2,
  fillColor: getRandomColour(),
  fillOpacity: 0.4,
  click: function(clickEvent) {
    var position = clickEvent.latLng;

    infoWindow.setPosition(position);
    infoWindow.open(map.map);
  }
});}
console.log(map);
} 
    </script>
  </body>
</html>
