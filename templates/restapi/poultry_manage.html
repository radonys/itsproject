<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Farmer Everywhere</title>

    {%load staticfiles%}
    <!-- Bootstrap -->
    <link href="{% static 'farmereverywhere/css/bootstrap.min.css' %}" rel="stylesheet">
	<link rel="stylesheet" href="{% static 'farmereverywhere/css/font-awesome.min.css' %}">
	<link rel="stylesheet" href="{% static 'farmereverywhere/css/animate.css' %}">
	<link href="{% static 'farmereverywhere/css/prettyPhoto.css' %}" rel="stylesheet">
    <link href="{% static 'farmereverywhere/css/style.css' %}" rel="stylesheet" />
    <script src={% static "Chart.min.js" %}></script>
    <script src={% static "Chart.js" %}></script>
    <script src={% static "Chart.PieceLabel.min.js" %}></script>
    <style>

            .goog-te-banner-frame.skiptranslate {
              display: none !important;
              }
          body {
              top: 0px !important;
              }
    </style>
  </head>

  <body>
	<header>
		<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
			<div class="navigation">
				<div class="container">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse.collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<div class="navbar-brand">
                                <a href="{% url 'index'%}"><h1><span>Farmer</span>Everywhere</h1></a>
							</div>
						</div>

						<div class="navbar-collapse collapse">
							<div class="menu">
								<ul class="nav nav-tabs" role="tablist">
                                    <!--li role="presentation"><a href="#">Dashboard</a></li-->
                                <li role="presentation"><a href="{% url 'cropsug'%}">Crop Suggestions</a></li>
                                <li role="presentation"><a href="{% url 'poultry'%}">Poultry Management</a></li>
                                <li role="presentation"><a href="{% url 'cropdet' %}">Crop Details</a></li>
                                <li role="presentation"><a  href="{% url 'property'%}">Properties</a></li>
                                <li role="presentation"><div id="google_translate_element" style="padding-top: 0.31cm;"></div></li>
                                <script type="text/javascript">
                                    var ret="";
                                    function googleTranslateElementInit() { ret =
                                        new google.translate.TranslateElement({pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
                                    }
                                </script>
                                <script type="text/javascript" src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
                                </ul>
						</div>
					</div>
				</div>
			</div>
		</nav>
	</header>

	<div id="breadcrumb">
		<div class="container">
			<div class="breadcrumb">
				<li><a href="{% url 'index'%}">Home</a></li>
				<li>Poultry Management</li>
			</div>
		</div>
	</div>

	<section id="portfolio">
        <div class="container">
            <div class="center">
               <p></p>
            </div>

            <ul class="portfolio-filter text-center">
                <li><a class="btn btn-default active" href="#" data-filter=".search">Search Results</a></li>
                <li><a class="btn btn-default" href="#" data-filter=".poultry">Your Poultry</a></li>
            </ul><!--/#portfolio-filter-->
        </div>

		<div class="container">

            <div class="">
                <div class="portfolio-items">
                    <div class="portfolio-item search col-md-12">
                        <div class="input-group add-on">
                            <input class="form-control" placeholder="Search" name="srch-term" id="srch-term" type="text">
                            <div class="input-group-btn">
                                <button class="btn btn-info" onclick="searchnews();"><i class="glyphicon glyphicon-search"></i> Search</button>
                            </div>
                        </div>

                        <div class="recent-work-wrap">
                            <div class="overlay">
                                <div class="recent-work-inner">
                                        <div class="row">
                                            <div class="col-md-12">
                                            <center><h3>Poultry Search Results</h3></center>
                                                <table class="table table-bordered" id="news" onload="console.log('fuck')">
                                                    <tr>
                                                        <td rowspan="8">Nam tempor velit sed turpis imperdiet vestibulum. In mattis leo ut sapien euismod id feugiat mauris euismod. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Phasellus id nulla risus, vel tincidunt turpis. Aliquam a nulla mi, placerat blandit eros. In neque lectus, lobortis a varius a, hendrerit eget dolor. Fusce scelerisque, sem ut viverra sollicitudin, est turpis blandit lacus, in pretium lectus sapien at est. Integer pretium ipsum sit amet dui feugiat vitae dapibus odio eleifend. As a describer of life and manners, he must be allowed to stand perhaps the first of the first rank. His humour, which, as Steele observes, is peculiar to himself, is so happily diffused as to give the grace of novelty to domestic scenes and daily occurrences. He never "o'ersteps the modesty of nature," nor raises merriment or wonder by the violation of truth. His figures neither divert by distortion nor amaze by aggravation. He copies life with so much fidelity that he can be hardly said to invent; yet his exhibitions have an air so much original, that it is difficult to suppose them not merely the product of imagination.</td>
                                                    </tr>
                                                    <tr>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div><!--/.portfolio-item-->
                </div>
            </div>


            <div class="">
                <div class="portfolio-items"  id="hide">
                    <div class="portfolio-item poultry col-md-12">
                      <center>
                        <select id="drop-state">
                        </select>


                                <canvas style="align:center" id="radar-chart"></canvas></div>
                                </center>
                  <!--/.portfolio-item-->
                </div>
            </div>


        </div>
    </section><!--/#portfolio-item-->


	<footer>
		<div class="footer">
			<div class="container">
				<div class="social-icon">
					<div class="col-md-4">
						<ul class="social-network">
							<li><a href="#" class="fb tool-tip" title="Facebook"><i class="fa fa-facebook"></i></a></li>
							<li><a href="#" class="twitter tool-tip" title="Twitter"><i class="fa fa-twitter"></i></a></li>
							<li><a href="#" class="gplus tool-tip" title="Google Plus"><i class="fa fa-google-plus"></i></a></li>
							<li><a href="#" class="linkedin tool-tip" title="Linkedin"><i class="fa fa-linkedin"></i></a></li>
							<li><a href="#" class="ytube tool-tip" title="You Tube"><i class="fa fa-youtube-play"></i></a></li>
						</ul>
					</div>
				</div>

				<div class="col-md-4 col-md-offset-4">
					<div class="copyright">
						&copy; Farmer Everywhere. All Rights Reserved.
                        <div class="credits">
                        </div>
					</div>
				</div>
			</div>
			<div class="pull-right">
				<a href="#home" class="scrollup"><i class="fa fa-angle-up fa-3x"></i></a>
			</div>
		</div>
	</footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="{% static 'farmereverywhere/js/jquery-2.1.1.min.js' %}"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="{% static 'farmereverywhere/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'farmereverywhere/js/jquery.prettyPhoto.js' %}"></script>
    <script src="{% static 'farmereverywhere/js/jquery.isotope.min.js' %}"></script>
    <script src="{% static 'farmereverywhere/js/wow.min.js' %}"></script>
    <script src="{% static 'farmereverywhere/js/functions.js' %}"></script>
    <script>
    $(document).ready(
    function (){
      console.log("called!")
      fetch("{% url 'poultry_news' %}")
      .then(function(response){return response.json()})
      .then(function(data){
          console.log("the data is :",data)
          var str = "";
          var dat = data;
          for(var i =0;i<dat.length;i++)
          {
            str+="<tr><th><div class='row'><div class='col-md-8'><a href='"+dat[i].link+"' target='_blank' style='text-align:right;'>"+dat[i].title+"</a></div></div><div class='row'><div class='col-md-12' style='text-align:right;'>"+dat[i].description+"</div></div></th></tr>";
          }
          document.getElementById("news").innerHTML = str;
      });
    });
    function searchnews(){
      fetch("{% url 'searchnews' %}",{
        method:'post',
        body:JSON.stringify({query:document.getElementById("srch-term").value})}
      )
      .then(function(response){return response.json()})
      .then(function(data){
          console.log("the searchnews data is :",data)
          var str = "";
          var dat = data;
          for(var i =0;i<dat.length;i++)
          {
            str+="<tr><th><div class='row'><div class='col-md-8'><a href='"+dat[i].link+"' target='_blank' style='text-align:right;'>"+dat[i].title+"</a></div></div><div class='row'><div class='col-md-12' style='text-align:right;'>"+dat[i].description+"</div></div></th></tr>";
          }
          document.getElementById("news").innerHTML = str;
      });
    }
    </script>
    <script>
    $('#drop-state').change(function()  {
      St=$('#drop-state').val();
      console.log(St);
      makechart(St);

    });
    data={{data|safe}}
    labels={{labels|safe}}
    states={{states|safe}}
    for (var i = 0; i<states.length; i++){
        var opt = document.createElement('option');
        opt.value = states[i];
        opt.innerHTML = states[i];
        document.getElementById('drop-state').appendChild(opt);
    }
    var dataArr=[];
    var x=null;
    St=$('#drop-state').val();
    console.log(St);
    var bgcolor=[]
    for(i=0;i<labels.length;i++)
    {
      bgcolor.push(getRandomColor());
    }
    makechart(St);
            function getRandomColor() {
            var letters = '0123456789ABCDEF'.split('');
            var color = '#';
            for (var i = 0; i < 6; i++ ) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }


        function makechart(State){
          console.log(data);
            dataArr=[];
          for(i=0;i<data.length;i++)
          {


            if(data[i][0]==State)
            {
              for(j=2;j<data[i].length;j++)
              {
                console.log(data[i][j]);
                dataArr.push(parseInt(data[i][j]))
              }
            }
          }
          console.log(dataArr);
          if(x)
            x.clear()
          x=new Chart(document.getElementById("radar-chart"), {
          type: 'doughnut',
          data: {
            datasets: [{
              data: dataArr,
              backgroundColor: bgcolor,
              label: 'Poultry Count(x100)'
            }],
            labels: labels
          },
          options:{
            title: {
              display: true,
              text: State
            },
          pieceLabel: {
            render: 'percentage',
            fontColor: '#000',
            position: 'outside',
            precision: 2
          }
        }

      });}

            </script>

</body>
</html>
